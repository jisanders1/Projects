# Lox: Bytecode Implementation in C
Jaylon Sanders: CS 403

This folder containts the workings of a Lox interpreter via a virtual machine in C. I used the book "Crafting Interpreters" and modified the code slightly. These modifications often included changing names where I feel a more understandable name could be used, switching switch statements for if statements and vice-versa, and switching some for loops to while loops where applicable.

## Compiling
In order to run the program, you should first make sure that you have the ability to compile and run C code. If you are running a Linux based system, then there is a high chance that it is already installed on your computer. If you are using a Windows, you should install the MinGW compiler (for instructions to compile go (here)[https://www.geeksforgeeks.org/installing-mingw-tools-for-c-c-and-changing-environment-variable/]). 

If you wish to enter debug mode, un-comment line 10 of the file ```common.h```. Debug mode will print extra information, such as the op_codes that the program utilizes and the stack of values that is used for evaluating expressions. If you wish to simply run a program, you should leave line 10 as a comment.

Finally, navigate to the ```Sources``` folder and enter the following line of code to compile the source files:
```
gcc main.c debug.c chunk.c memory.c value.c vm.c -o clox
```
## Running
After you enter this command, the program sholud be compiled to an executable. In order to run the program, you should type invoke the executable file, which may end in ".exe" or ".out" for most. For Windows users, you should be able to type the following.:
```
clox
```

The current program in ```main.c``` will output the opcodes and result for the expression -((1.2 + 3.4) / 5.6). 
The output should look like the following when not in debug mode: 
```
== test chunk ==
0000  123 CONSTANT_OP         0 '1.2'
0002    | CONSTANT_OP         1 '3.4'
0004    | ADD_OP
0005    | CONSTANT_OP         2 '5.6'
0007    | DIVIDE_OP
0008    | NEGATE_OP
0009    | RETURN_OP
-0.821429

```
when in debug mode, the output looks like the following:
```
== test chunk ==
0000  123 CONSTANT_OP         0 '1.2'
0002    | CONSTANT_OP         1 '3.4'
0004    | ADD_OP
0005    | CONSTANT_OP         2 '5.6'
0007    | DIVIDE_OP
0008    | NEGATE_OP
0009    | RETURN_OP
Val Stack:

0000  123 CONSTANT_OP         0 '1.2'
Val Stack: [ 1.2 ]

0002    | CONSTANT_OP         1 '3.4'
Val Stack: [ 1.2 ][ 3.4 ]

0004    | ADD_OP
Val Stack: [ 4.6 ]

0005    | CONSTANT_OP         2 '5.6'
Val Stack: [ 4.6 ][ 5.6 ]

0007    | DIVIDE_OP
Val Stack: [ 0.821429 ]

0008    | NEGATE_OP
Val Stack: [ -0.821429 ]

0009    | RETURN_OP
-0.821429

```

## Progresion
You can find a copy of my code after each chapter in the ```Progression``` folder. To run these, you should unzip them to a location outside of this folder and complete the instructions fro running above.

Chapter 14 - Chunks of Bytecode:
- Added basic functionality for encoding constant and return operations, and for encoding constants and values.
- Separated source and header files into two separate directories.
- Added ```.gitignore``` to not track any executables generated by the user.

Chapter 15 - A Virtual Machine:
- Added arithmetic operators and the ability to evaluate expressions.
- Updated ```.gitignore``` to not track additional compilation side effects (such as ```clox.exe.stackdump```).
- Updated and added comments above functions and wtihin them to detail what is happening.
- Made some changes to the debugger to more easily associate what is happening in the stack with the op codes.

## Issues
- The compilation process is a bit long. Perhaps making a makefile will reduce difficulty. 